const _0x1d1988=_0x10cb;(function(_0x372ac5,_0x2f8c2a){const _0x59e0f0=_0x10cb,_0x5379d5=_0x372ac5();while(!![]){try{const _0x449e3c=parseInt(_0x59e0f0(0xc4))/0x1+parseInt(_0x59e0f0(0xbc))/0x2*(parseInt(_0x59e0f0(0xaa))/0x3)+-parseInt(_0x59e0f0(0xb0))/0x4*(-parseInt(_0x59e0f0(0x9f))/0x5)+parseInt(_0x59e0f0(0xae))/0x6*(-parseInt(_0x59e0f0(0xc1))/0x7)+parseInt(_0x59e0f0(0xc2))/0x8*(parseInt(_0x59e0f0(0x9d))/0x9)+-parseInt(_0x59e0f0(0xa5))/0xa*(parseInt(_0x59e0f0(0xb4))/0xb)+-parseInt(_0x59e0f0(0xaf))/0xc*(parseInt(_0x59e0f0(0xa8))/0xd);if(_0x449e3c===_0x2f8c2a)break;else _0x5379d5['push'](_0x5379d5['shift']());}catch(_0x2f9266){_0x5379d5['push'](_0x5379d5['shift']());}}}(_0x4fa1,0xf29ce));const mongoose=require(_0x1d1988(0xba)),uniqueValidator=require(_0x1d1988(0xac)),bcrypt=require('bcrypt'),{MyCustomError}=require(_0x1d1988(0x9c)),{getPresignedUrl}=require('../aws/s3'),s3ObjectSchema=new mongoose[(_0x1d1988(0xa1))]({'key':String,'url':String}),adminSchema=new mongoose[(_0x1d1988(0xa1))]({'name':{'type':String,'required':!![]},'phoneNumber':{'type':String,'required':!![],'unique':!![]},'address':{'type':String},'email':{'type':String},'adminUid':{'type':String,'unique':!![]},'gender':{'type':String,'required':!![],'enum':[_0x1d1988(0xad),_0x1d1988(0xa7),_0x1d1988(0xb8)]},'dob':{'type':Date,'required':!![],'validate':{'validator':function(_0x4ea28e){const _0x22f28c=_0x1d1988,_0x9b6c9=new Date(),_0x25dec2=_0x9b6c9[_0x22f28c(0xa3)]()-_0x4ea28e[_0x22f28c(0xa3)]();return _0x25dec2>=0x12&&_0x4ea28e<=_0x9b6c9;},'message':_0x1d1988(0xc3)}},'password':{'type':String,'required':!![]},'deleteStatus':{'type':String,'default':_0x1d1988(0xb2),'enum':[_0x1d1988(0xc5),_0x1d1988(0xb2)]},'anniversary':Date,'profilePic':s3ObjectSchema},{'timestamps':!![]});adminSchema['index']({'email':0x1},{'unique':!![],'sparse':!![]}),adminSchema['index']({'name':0x1,'phoneNumber':0x1,'deleteStatus':0x1}),adminSchema[_0x1d1988(0xbf)]({'email':0x1,'phoneNumber':0x1}),adminSchema[_0x1d1988(0xbb)](uniqueValidator,{'message':_0x1d1988(0xbd)});async function generateAdminUid(){const _0x49c5ee=_0x1d1988,_0x4e9066=this[_0x49c5ee(0xa6)](_0x49c5ee(0xb3)),_0x4af501=await _0x4e9066['findOne']({},{'adminUid':0x1},{'sort':{'adminUid':-0x1}});if(_0x4af501){const _0x340f7d=parseInt(_0x4af501['adminUid'],0xa);newUid=(_0x340f7d+0x1)['toString']()['padStart'](0x8,'0');}else newUid=_0x49c5ee(0x9b);return newUid;}function _0x4fa1(){const _0x19c2df=['97657OsmGoH','31056MOgmZk','Invalid\x20DOB.\x20Admin\x20must\x20be\x20at\x20least\x2018\x20years\x20old\x20and\x20DOB\x20cannot\x20be\x20in\x20the\x20future.','1308097ZmzZNe','true','call','00000001','../middlewares/error/error.handler','2628QBlULI','login','42495CiKBvH','compare','Schema','Invalid\x20credentials','getFullYear','adminUid','10NeUbIb','model','Female','9474777jDLUMv','findOne','5103996iaEOhD','save','mongoose-unique-validator','Male','216EsqbzN','36QcfSez','284hMuaQH','pre','false','Admin','11703307RxoOqO','hash','password','key','Other','statics','mongoose','plugin','2XJGoCF','{PATH}\x20Already\x20exists.','profilePic','index','url'];_0x4fa1=function(){return _0x19c2df;};return _0x4fa1();}function _0x10cb(_0x3dbf47,_0x17a866){const _0x4fa1ee=_0x4fa1();return _0x10cb=function(_0x10cbf1,_0xaf4d5){_0x10cbf1=_0x10cbf1-0x9a;let _0x50f42c=_0x4fa1ee[_0x10cbf1];return _0x50f42c;},_0x10cb(_0x3dbf47,_0x17a866);}adminSchema[_0x1d1988(0xb1)](_0x1d1988(0xab),async function(_0x23770d){const _0xf3c929=_0x1d1988;try{!this[_0xf3c929(0xa4)]&&(this[_0xf3c929(0xa4)]=await generateAdminUid[_0xf3c929(0x9a)](this));if(!this['isModified'](_0xf3c929(0xb6)))return _0x23770d();const _0x2fcbc8=0xa,_0x107cdd=await bcrypt[_0xf3c929(0xb5)](this[_0xf3c929(0xb6)],_0x2fcbc8);this[_0xf3c929(0xb6)]=_0x107cdd,_0x23770d();}catch(_0x4ab837){_0x23770d(_0x4ab837);}}),adminSchema[_0x1d1988(0xb9)][_0x1d1988(0x9e)]=async function(_0x3deb06,_0xd03cd2){const _0x3e8fb2=_0x1d1988,_0xb661f3=await this[_0x3e8fb2(0xa9)]({'$or':[{'email':_0x3deb06},{'phoneNumber':_0x3deb06}]});if(!_0xb661f3)throw new MyCustomError(0x190,_0x3e8fb2(0xa2));const _0x4eb1a9=await bcrypt[_0x3e8fb2(0xa0)](_0xd03cd2,_0xb661f3['password']);if(!_0x4eb1a9)throw new MyCustomError(0x190,'Invalid\x20credentials');if(_0xb661f3['profilePic']){const _0x4ac384=await getPresignedUrl(_0xb661f3[_0x3e8fb2(0xbe)][_0x3e8fb2(0xb7)]);_0xb661f3[_0x3e8fb2(0xbe)][_0x3e8fb2(0xc0)]=_0x4ac384;}return _0xb661f3;},module['exports']=mongoose[_0x1d1988(0xa6)](_0x1d1988(0xb3),adminSchema);